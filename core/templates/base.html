{% load static tailwind_tags %}
<!DOCTYPE html>
<html lang="en" hx-ext="oob">

<head>
    <title>{% block title %}Luxora{% endblock %}</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="{{ csrf_token }}">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;700&display=swap"
        rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
    {% tailwind_css %}
    <script src="https://unpkg.com/htmx.org@1.9.2"></script>
</head>

<body class="bg-white text-black" style="font-family: 'Plus Jakarta Sans', sans-serif;">

    <!-- Drawer wrapper -->
    <div class="drawer drawer-end z-50 min-h-screen">

        <!-- Drawer toggle -->
        <input id="cart-drawer" type="checkbox" class="drawer-toggle" />

        <!-- Page content -->
        <div class="drawer-content flex flex-col min-h-screen">

            <!-- Navbar -->
            {% block navbar %}
            {% include "partials/navbar.html" %}
            {% endblock %}

            <!-- Main content -->
            <main class="w-full {% if not content_block %}pt-20{% endif %} flex-1">
                {% block content %}{% endblock %}
            </main>

            <!-- Footer -->
            {% block footer %}
            {% include 'partials/footer.html' %}
            {% endblock %}
        </div>

        <!-- Quick View Modal -->
        <div id="quickview-container"></div>


        <!-- Drawer side -->
        {% include "partials/drawer.html" %}

    </div>
    <script>
        // Sau khi HTMX load modal, thêm class "flex" để hiển thị
        document.body.addEventListener("htmx:afterSwap", (e) => {
            if (e.detail.target.id === "quickview-container") {
                const modal = document.getElementById("quickview-modal");
                if (modal) modal.classList.remove("hidden");
                if (modal) modal.classList.add("flex");
            }
        });
    </script>
    <!-- HTMX CSRF helper -->
    <script>
        (function () {
            function getCookie(name) {
                const match = document.cookie.match('(^|;)\\s*' + name + '\\s*=\\s*([^;]+)');
                return match ? match.pop() : null;
            }
            function getCSRF() {
                const meta = document.querySelector('meta[name="csrf-token"]');
                if (meta && meta.content) return meta.content;
                return getCookie('csrftoken');
            }
            document.body.addEventListener('htmx:configRequest', function (event) {
                const token = getCSRF();
                if (token) event.detail.headers['X-CSRFToken'] = token;
            });
        })();
    </script>
</body>

</html>