{% extends 'base.html' %}
{% load static %}

{% block content %}
<!-- banner section -->
<section class="flex flex-col items-center justify-center w-full h-64 md:h-80 lg:h-96 bg-cover bg-center text-white mb-4"
  style="background-image: url({% static 'core/images/banner.png' %});">
  <h1 class="text-4xl font-bold drop-shadow-lg">Khám phá sản phẩm của chúng tôi</h1>
</section>

<section class="max-w-screen-2xl mx-auto px-4 py-8">
  <!-- Layout: Bộ lọc + Danh sách sản phẩm -->
  <div class="flex gap-8">

    <!-- Bộ lọc (Sidebar trái) -->
    <aside class="flex-[1] bg-transparent h-fit">
      <h2 class="text-lg font-semibold mb-4 border-b pb-2">Bộ lọc sản phẩm</h2>

      <!-- Category filter -->
      <div class="mb-6">
        <h3 class="text-sm font-medium text-gray-700 mb-2">Danh mục</h3>
        <ul class="space-y-2">
          <li>
            <a href="{% url 'products:list' %}"
               hx-get="{% url 'products:list' %}"
               hx-target="#product-list"
               hx-swap="innerHTML"
               hx-push-url="true"
               class="block text-gray-600 hover:text-black transition">
              Tất cả sản phẩm
            </a>
          </li>
          {% for category in categories %}
          <li>
            <a href="{% url 'products:category' category.slug %}"
               hx-get="{% url 'products:category' category.slug %}"
               hx-target="#product-list"
               hx-swap="innerHTML"  
               hx-push-url="true"
               class="block text-gray-600 hover:text-black transition">
              {{ category.name }}
            </a>
          </li>
          {% empty %}
          <li class="text-gray-400 text-sm">Chưa có danh mục</li>
          {% endfor %}
        </ul>
      </div>
    </aside>

    <!-- Danh sách sản phẩm -->
    <div class="flex-[3]">
      <!-- Thanh sắp xếp -->
      <div class="flex justify-end items-center mb-4">
        <label for="sort" class="text-sm text-gray-700 mr-2">Sắp xếp theo:</label>
        <select id="sort"
          name="sort"
          hx-get="{% if slug %}{% url 'products:category' slug %}{% endif %}"
          hx-target="#product-list"
          hx-swap="innerHTML"
          hx-push-url="true"
          onchange="this.setAttribute('hx-vals', JSON.stringify({sort: this.value}))"
          class="border border-gray-300 rounded-md px-2 py-1 text-sm">

    <option value="">Mặc định</option>
    <option value="price_asc" {% if sort == 'price_asc' %}selected{% endif %}>Giá: Thấp → Cao</option>
    <option value="price_desc" {% if sort == 'price_desc' %}selected{% endif %}>Giá: Cao → Thấp</option>
</select>

      </div>

      <div id="product-list">
        {% include 'products/partials/product_grid.html' with products=products %}
      </div>
    </div>
  </div>
</section>
{% endblock %}
